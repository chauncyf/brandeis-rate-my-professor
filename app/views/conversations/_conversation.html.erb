<div class="card rounded-0 border-0 conversation-container" data-conversation-id="<%= conversation.id %>" style="height: 90vh">
	<div class="card-header bg-transparent rounded-0 msg-header d-flex align-items-center justify-content-between justify-content-lg-start" style="height: 8vh;">
		<a id="btn-back" onclick="backbtn()"><i class="fas fa-chevron-left fa-2x text-primary d-lg-none d-xl-none"></i></a>
		<%= link_to "#{conversation.opposed_user(user).show_full_name ||= conversation.opposed_user(user).email}", user_path(conversation.opposed_user(user).id), method: :get, class: "h3 my-2 ml-2" %>
	</div>
	<div class="card-body msg-body" style="height:65vh;">
		<div class="messages-list">
			<ul>
				<%= render 'conversations/conversation_content', messages: conversation.messages, user: user %>
			</ul>
		</div>
	</div>
	<div class="dropdown-divider mb-0"></div>
	<div class="card-body msg-form pt-0 container-fluid">
		<div class="row ml-4 d-block mb-1" style="width:85%;height:30%;">
			<% if !conversation.messages.any? %>
				<div class="btns row align-items-center text-center mr-2 suggestions flex-nowrap">
					<% new_conversation_suggestion(conversation).each do |style, text| %>
						<a class="col">
							<span class="<%= style %>"><%= text %></span>
						</a>
					<% end %>
				</div>
			<% else %>
				<div class="attachments row ml-lg-4 ml-xl-4 mx-0 h-100 align-items-center">
					<div class="attachment-container">
						<label for="attachment" class="m-0" id="attach">
							<a><i class="fas fa-paperclip fa-lg text-secondary mr-2"></i></a>
						</label>
						<input id="attachment" type="file" accept='image/png,image/jpg,image/jpeg' class="d-none">
					</div>
					<div class="attachment-btns">
						<button type="button" id="attachment-1" class="btn-sm m-0 mr-2 py-0 btn-primary rounded-pill">
							<i class="fas fa-file-image mr-1"></i>
							img.png
						</button>
					</div>
				</div>
			<% end %>
		</div>
		<div class="input-msg-container mx-lg-4 mx-xl-4 mx-0 d-xs-flex d-sm-flex d-md-flex">
			<form class="new_message d-flex align-items-center w-100">
				<input name="conversation_id" type="hidden" value="<%= conversation.id %>">
				<input name="user_id" type="hidden" value="<%= user.id %>">
				<div class="col-lg-11 col-xl-11 col-9">
					<textarea name="body" id="msg-textarea" class="form-control overflow-auto" style="resize: none;"></textarea>
				</div>
				<div class="col">
					<%= button_tag class: "btn btn-lg bg-transparent btn-msg" do %>
						<i class="fas fa-paper-plane fa-lg"></i>
					<% end %>
				</div>
			</form>
		</div>
	</div>
</div>
<script>
	$("a .badge").click(function(e) {
	  	e.preventDefault();
	  	var message = $(this).html();
	  	$('textarea').val(message);
	});
	
	function backbtn() {
		$("#conversations-list").addClass("d-none");
		$(".users-container").removeClass("d-none");
	}

	// if ($(".attachment-btns button").length >= 2) {
	// 	$("#attachment").prop("disabled", true);
	// }

	// 	$("#attachment").on("change", function() {
	// 		console.log("IMHERE")
	// 		var fd = new FormData();
	// 		fd.append('file', this.files[0])

	// 		$.ajax({
	// 			type: 'POST',
	// 			url: '/attach',
	// 			data: fd,
	// 			success(data) {
	// 				console.log("attached", data);
	// 				return false;
	// 			},
	// 			error(data) {
	// 				console.log("error", data);
	// 				return false;
	// 			},
	// 			contentType: false,
	// 			processData: false
	// 		});
	// 	});
</script>
